# Multimodal Sentiment Analysis (å¤šæ¨¡æ€æƒ…æ„Ÿåˆ†ç±»)

æœ¬ä»“åº“æ˜¯ å®éªŒäº”ï¼šå¤šæ¨¡æ€æƒ…æ„Ÿåˆ†ç±» çš„ä»£ç å®ç°ã€‚

ä»»åŠ¡ç›®æ ‡æ˜¯ç»™å®šé…å¯¹çš„æ–‡æœ¬ï¼ˆTextï¼‰å’Œå›¾åƒï¼ˆImageï¼‰ï¼Œé¢„æµ‹å…¶æƒ…æ„Ÿæ ‡ç­¾ï¼ˆPositive, Neutral, Negativeï¼‰ã€‚

## ğŸ“– é¡¹ç›®ä»‹ç» (Introduction)

æœ¬é¡¹ç›®åŸºäº **PyTorch** æ¡†æ¶ï¼Œè®¾è®¡äº†ä¸€ä¸ª **Late Fusion (åèåˆ)** çš„å¤šæ¨¡æ€æ·±åº¦å­¦ä¹ æ¨¡å‹ ã€‚

- **æ–‡æœ¬ç«¯**ï¼šä½¿ç”¨é¢„è®­ç»ƒçš„ **BERT-base-uncased** æå–è¯­ä¹‰ç‰¹å¾ã€‚
- **å›¾åƒç«¯**ï¼šä½¿ç”¨é¢„è®­ç»ƒçš„ **ResNet-50** æå–è§†è§‰ç‰¹å¾ã€‚
- **èåˆç­–ç•¥**ï¼šå°†ä¸¤è€…çš„ç‰¹å¾å‘é‡æ‹¼æ¥ï¼ˆConcatenationï¼‰ï¼Œå¹¶é€šè¿‡å…¨è¿æ¥å±‚ï¼ˆMLPï¼‰è¿›è¡Œåˆ†ç±»ã€‚

## ğŸ“‚ æ–‡ä»¶ç»“æ„ (File Structure)

```
Multimodal_Experiment/
â”œâ”€â”€ data/                   # æ•°æ®é›†æ–‡ä»¶å¤¹ (åŒ…å« guid.txt, guid.jpg, ä¸åŒ…å«åœ¨gitä¸­) [cite: 9]
â”œâ”€â”€ src/                    # æ ¸å¿ƒæºä»£ç 
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ dataset.py          # æ•°æ®åŠ è½½ä¸é¢„å¤„ç† (Data Loader & Preprocessing)
â”‚   â”œâ”€â”€ model.py            # å¤šæ¨¡æ€æ¨¡å‹æ¶æ„å®šä¹‰ (ResNet + BERT)
â”‚   â””â”€â”€ utils.py            # å·¥å…·å‡½æ•° (éšæœºç§å­å›ºå®šç­‰)
â”œâ”€â”€ train.txt               # è®­ç»ƒé›†æ ‡ç­¾æ–‡ä»¶
â”œâ”€â”€ test_without_label.txt  # æµ‹è¯•é›†æ–‡ä»¶ 
â”œâ”€â”€ main.py                 # ä¸»ç¨‹åºå…¥å£ (åŒ…å«è®­ç»ƒã€éªŒè¯ã€æµ‹è¯•ã€æ¶ˆèå®éªŒé€»è¾‘)
â”œâ”€â”€ requirements.txt        # ç¯å¢ƒä¾èµ–åŒ…åˆ—è¡¨ 
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜æ–‡æ¡£ 
```

## ğŸ› ï¸ ç¯å¢ƒä¾èµ– (Requirements)

è¯·ç¡®ä¿å®‰è£… Python 3.8+ ç‰ˆæœ¬ã€‚è¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…æ‰€éœ€ä¾èµ– 3ï¼š

```
pip install -r requirements.txt
```

ä¸»è¦ä¾èµ–åº“ï¼š

- `torch`, `torchvision`
- `transformers` (HuggingFace)
- `pandas`, `pillow`, `scikit-learn`, `tqdm`

## ğŸš€ è¿è¡Œæ–¹æ³• (Usage)

### 1. å‡†å¤‡æ•°æ®

è¯·ç¡®ä¿ `data/` æ–‡ä»¶å¤¹ä½äºé¡¹ç›®æ ¹ç›®å½•ï¼Œå¹¶ä¸”åŒ…å«æ‰€æœ‰çš„ `.jpg` å’Œ `.txt` æ–‡ä»¶ã€‚

### 2. è®­ç»ƒæ¨¡å‹ (Training)

è¿è¡Œä¸»ç¨‹åºå³å¯å¼€å§‹è®­ç»ƒã€‚ç¨‹åºä¼šè‡ªåŠ¨åˆ’åˆ†éªŒè¯é›†ï¼Œå¹¶åœ¨è®­ç»ƒç»“æŸåç”Ÿæˆæµ‹è¯•é›†é¢„æµ‹ç»“æœã€‚

```
python main.py
```

- é»˜è®¤é…ç½®ï¼šEpochs=3, Batch Size=32, LR=2e-5ã€‚
- è®­ç»ƒå®Œæˆåï¼Œæœ€ä½³æ¨¡å‹æƒé‡ä¼šä¿å­˜ä¸º `best_model.pth`ã€‚
- æµ‹è¯•é›†é¢„æµ‹ç»“æœå°†ä¿å­˜ä¸º `test_result.txt` ã€‚

### 3. æ¶ˆèå®éªŒ (Ablation Study)

æœ¬é¡¹ç›®æ”¯æŒé€šè¿‡ä¿®æ”¹ `main.py` ä¸­çš„å…¨å±€å˜é‡ `ABLATION` æ¥è¿›è¡Œæ¶ˆèå®éªŒ ã€‚

æ‰“å¼€ `main.py` å¹¶ä¿®æ”¹é…ç½®åŒºåŸŸï¼š

```
# é€‰é¡¹: 'none' (å…¨æ¨¡æ€), 'text_only' (ä»…æ–‡æœ¬), 'image_only' (ä»…å›¾åƒ)
ABLATION = "text_only" 
```

ç„¶åé‡æ–°è¿è¡Œ `python main.py` å³å¯ã€‚

## ğŸ“Š å®éªŒç»“æœ (Results)

åŸºäºéªŒè¯é›† (Validation Set) çš„å®éªŒç»“æœå¦‚ä¸‹ ï¼š

| **æ¨¡å‹æ¶æ„ (Architecture)** | **è¾“å…¥æ¨¡æ€ (Modality)** | **éªŒè¯é›†å‡†ç¡®ç‡ (Best Val Acc)** | **è¡¨ç°åˆ†æ**                           |
| --------------------------- | ----------------------- | ------------------------------- | -------------------------------------- |
| **Multimodal (Ours)**       | **Image + Text**        | **72.25%**                      | **èåˆæ•ˆæœæœ€å¥½ï¼Œè®­ç»ƒæ›²çº¿æœ€ç¨³å®šã€‚**     |
| Ablation Study              | Image Only              | 65.38%                          | å›¾åƒåŒ…å«è¾ƒå¤šæƒ…æ„Ÿçº¿ç´¢ï¼Œè¡¨ç°ä¼˜äºçº¯æ–‡æœ¬ã€‚ |
| Ablation Study              | Text Only               | 59.62%                          | æ–‡æœ¬è¾ƒçŸ­ä¸”å«å™ªå£°ï¼Œå•æ¨¡æ€ä¸‹è®­ç»ƒä¸ç¨³å®šã€‚ |

> **å®éªŒç»“è®º**ï¼šå¤šæ¨¡æ€èåˆæ¨¡å‹æ˜¾è‘—ä¼˜äºå•æ¨¡æ€æ¨¡å‹ï¼Œä¸”æœ‰æ•ˆè§£å†³äº†ä»…ä½¿ç”¨æ–‡æœ¬æ—¶å‡ºç°çš„æ¨¡å‹åå¡Œï¼ˆModel Collapseï¼‰é—®é¢˜ã€‚

## ğŸ”— å‚è€ƒèµ„æ–™ (References)

åœ¨ä»£ç å®ç°è¿‡ç¨‹ä¸­å‚è€ƒäº†ä»¥ä¸‹å¼€æºä»“åº“å’Œè®ºæ–‡ ï¼š

1. **GloGNN**: https://github.com/RecklessRonan/GloGNN 
2. **HuggingFace Transformers**: https://github.com/huggingface/transformers
3. **ResNet (PyTorch)**: Deep Residual Learning for Image Recognition (CVPR 2016)